---
title: "Joins and Lubridate"
date: "2024-02-29"
output:
  html_document: 
    theme: spacelab
    toc: yes
    toc_float: yes
    keep_md: yes
---



## Learning Goals
*At the end of this exercise, you will be able to:*  
1. List and join multiple files from a directory.  
2. Format dates in a data frame. 

## Listing Files in Folder
Often, the data we need is split up into multiple files, either by some geographical variable such as county, or by a time constituent such as months or weeks. The best method to deal with data in multiple files will be quick and also reproducible. We want to avoid doing anything by hand (besides very minor editing) to the original files someone sends us. We want everything to be reproducible so we can easily track any problems or errors that may crop up and prevent us from making careless errors ourselves.  

So copying/pasting multiple files together isn't an option for us. Let's see how we can do this in R. In the `data/spiders` folder there are 32 files, each named for a county in California. Each file contains a record of an observation of a species of cave spider. Each observation contains a unique ID for each spider as well as some other important information such as date and location name. Let's use R to list all the `.csv` files in the `spiders` folder.  

But first, load the tidyverse and the other packages we have been using.

```r
library("tidyverse")
library("janitor")
library("lubridate") #this will help us manage dates
```

Now we can list all of the files in a directory. This is very helpful when you are working with multiple files at once. We can also get the full path names with `full.names = TRUE`.

```r
files <- list.files(path = "data/spiders", pattern = ".csv", full.names = TRUE)
files
#>  [1] "data/spiders/Alameda .csv"        "data/spiders/Amador .csv"        
#>  [3] "data/spiders/Butte .csv"          "data/spiders/Calaveras .csv"     
#>  [5] "data/spiders/Contra Costa .csv"   "data/spiders/Del Norte .csv"     
#>  [7] "data/spiders/El Dorado .csv"      "data/spiders/Humboldt .csv"      
#>  [9] "data/spiders/Kern .csv"           "data/spiders/Marin .csv"         
#> [11] "data/spiders/Mariposa .csv"       "data/spiders/Mendocino .csv"     
#> [13] "data/spiders/Monterey .csv"       "data/spiders/Napa .csv"          
#> [15] "data/spiders/Placer .csv"         "data/spiders/Plumas .csv"        
#> [17] "data/spiders/San Bernandino .csv" "data/spiders/San Francisco .csv" 
#> [19] "data/spiders/San Mateo .csv"      "data/spiders/Santa Clara .csv"   
#> [21] "data/spiders/Santa Cruz .csv"     "data/spiders/Shasta .csv"        
#> [23] "data/spiders/Sierra .csv"         "data/spiders/Siskiyou .csv"      
#> [25] "data/spiders/Solano .csv"         "data/spiders/Sonoma .csv"        
#> [27] "data/spiders/Stanislaus .csv"     "data/spiders/Tehama .csv"        
#> [29] "data/spiders/Trinity .csv"        "data/spiders/Tulare .csv"        
#> [31] "data/spiders/Tuolumne .csv"       "data/spiders/Yolo .csv"
```

Now we want to read each of these files into R without having to do them one at a time because there are quite a few. There are several ways to do this, but a quick and straightforward way is to import them as a list. A list in R is an object which can store multiple other objects of the same or differing types. Lists are common in R so it's useful to be comfortable with them.  

Let's import our .csv files into a list. The `lapply()` function is a part of the `apply` family of functions. It will iterate over elements of an object, apply a function we specify, and return a list. We have a character vector of file paths, so we want to iterate over all the path names and apply `read_csv()`.  

```r
spider_list <- lapply(files, read_csv)
```

We can view elements in our list with double brackets. Let's view the data for Butte county.

```r
spider_list[[3]]
#> # A tibble: 1 × 9
#>   Accession Family    Genus   Country State      County Locality Date  Collector
#>       <dbl> <chr>     <chr>   <chr>   <chr>      <chr>  <chr>    <chr> <chr>    
#> 1   9038509 Telemidae Usofila USA     California Butte  Dry Cre… 2/3/… RO Schus…
```

## Practice
1. Getting an idea of the structure of lists is a bit tricky, especially when there are many elements. Try exploring the elements in `spider_list` using names(), str(), or glimpse(). For names(), you will need to specify an element using [[]].  

```r
names(spider_list[[1]]) ## must use double brackets
#> [1] "Accession" "Family"    "Genus"     "Country"   "State"     "County"   
#> [7] "Locality"  "Date"      "Collector"
glimpse(spider_list)
#> List of 32
#>  $ : spc_tbl_ [12 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
#>   ..$ Accession: num [1:12] 9038521 9038522 9038523 9038524 9038525 ...
#>   ..$ Family   : chr [1:12] "Telemidae" "Telemidae" "Telemidae" "Telemidae" ...
#>   ..$ Genus    : chr [1:12] "Usofila" "Usofila" "Usofila" "Usofila" ...
#>   ..$ Country  : chr [1:12] "USA" "USA" "USA" "USA" ...
#>   ..$ State    : chr [1:12] "California" "California" "California" "California" ...
#>   ..$ County   : chr [1:12] "Alameda" "Alameda" "Alameda" "Alameda" ...
#>   ..$ Locality : chr [1:12] "Berkeley" "Castro Valley" "Niles, off Niles Cyn. on Palomares Rd." "Oakland" ...
#>   ..$ Date     : chr [1:12] "2/3/1958" "24/3/1941" "2/1/1964" "18/2/1953" ...
#>   ..$ Collector: chr [1:12] "LM Smith" "WM Pearce" "V Roth" "WG Bentinck" ...
#>   ..- attr(*, "spec")=
#>   .. .. cols(
#>   .. ..   Accession = col_double(),
#>   .. ..   Family = col_character(),
#>   .. ..   Genus = col_character(),
#>   .. ..   Country = col_character(),
#>   .. ..   State = col_character(),
#>   .. ..   County = col_character(),
#>   .. ..   Locality = col_character(),
#>   .. ..   Date = col_character(),
#>   .. ..   Collector = col_character()
#>   .. .. )
#>   ..- attr(*, "problems")=<externalptr> 
#>  $ : spc_tbl_ [8 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
#>   ..$ Accession: num [1:8] 9038530 9038531 9038532 9038533 9038534 ...
#>   ..$ Family   : chr [1:8] "Telemidae" "Telemidae" "Telemidae" "Telemidae" ...
#>   ..$ Genus    : chr [1:8] "Usofila" "Usofila" "Usofila" "Usofila" ...
#>   ..$ Country  : chr [1:8] "USA" "USA" "USA" "USA" ...
#>   ..$ State    : chr [1:8] "California" "California" "California" "California" ...
#>   ..$ County   : chr [1:8] "Amador" "Amador" "Amador" "Amador" ...
#>   ..$ Locality : chr [1:8] "Connie's Cave, 0.5 mi NW Volcano" "Lulu Bell Cave, nr Volcano" "Moss Cave, nr. Volcano" "Pardee Res., Chrome Cave" ...
#>   ..$ Date     : chr [1:8] "25/3/1995" "17/10/1987" "17/10/1987" "24/1/1981" ...
#>   ..$ Collector: chr [1:8] "D Ubick" "D Ubick" "D Ubick" "D Ubick" ...
#>   ..- attr(*, "spec")=
#>   .. .. cols(
#>   .. ..   Accession = col_double(),
#>   .. ..   Family = col_character(),
#>   .. ..   Genus = col_character(),
#>   .. ..   Country = col_character(),
#>   .. ..   State = col_character(),
#>   .. ..   County = col_character(),
#>   .. ..   Locality = col_character(),
#>   .. ..   Date = col_character(),
#>   .. ..   Collector = col_character()
#>   .. .. )
#>   ..- attr(*, "problems")=<externalptr> 
#>  $ : spc_tbl_ [1 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
#>   ..$ Accession: num 9038509
#>   ..$ Family   : chr "Telemidae"
#>   ..$ Genus    : chr "Usofila"
#>   ..$ Country  : chr "USA"
#>   ..$ State    : chr "California"
#>   ..$ County   : chr "Butte"
#>   ..$ Locality : chr "Dry Creek Rd, 14 mi N Oroville"
#>   ..$ Date     : chr "2/3/1956"
#>   ..$ Collector: chr "RO Schuster"
#>   ..- attr(*, "spec")=
#>   .. .. cols(
#>   .. ..   Accession = col_double(),
#>   .. ..   Family = col_character(),
#>   .. ..   Genus = col_character(),
#>   .. ..   Country = col_character(),
#>   .. ..   State = col_character(),
#>   .. ..   County = col_character(),
#>   .. ..   Locality = col_character(),
#>   .. ..   Date = col_character(),
#>   .. ..   Collector = col_character()
#>   .. .. )
#>   ..- attr(*, "problems")=<externalptr> 
#>  $ : spc_tbl_ [37 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
#>   ..$ Accession: num [1:37] 9038679 9038725 9038726 9038727 9038728 ...
#>   ..$ Family   : chr [1:37] "Telemidae" "Telemidae" "Telemidae" "Telemidae" ...
#>   ..$ Genus    : chr [1:37] "Usofila" "Usofila" "Usofila" "Usofila" ...
#>   ..$ Country  : chr [1:37] "USA" "USA" "USA" "USA" ...
#>   ..$ State    : chr [1:37] "California" "California" "California" "California" ...
#>   ..$ County   : chr [1:37] "Calaveras" "Calaveras" "Calaveras" "Calaveras" ...
#>   ..$ Locality : chr [1:37] "Porcupine Cave, 3 mi N of Columbia" "Fox Gulch, Lower von Trump Mine" "Buckeye Cave, WSI #C-6, Murphys, twilight zone" "King Tut Cave" ...
#>   ..$ Date     : chr [1:37] "28/2/1979" "23/9/1975" "11/6/1994" "22/12/1990" ...
#>   ..$ Collector: chr [1:37] "DC Rudolph, S Winterath, B Martin" "T Briggs, R Lem" "D Ubick" "Dave Cowan" ...
#>   ..- attr(*, "spec")=
#>   .. .. cols(
#>   .. ..   Accession = col_double(),
#>   .. ..   Family = col_character(),
#>   .. ..   Genus = col_character(),
#>   .. ..   Country = col_character(),
#>   .. ..   State = col_character(),
#>   .. ..   County = col_character(),
#>   .. ..   Locality = col_character(),
#>   .. ..   Date = col_character(),
#>   .. ..   Collector = col_character()
#>   .. .. )
#>   ..- attr(*, "problems")=<externalptr> 
#>  $ : spc_tbl_ [7 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
#>   ..$ Accession: num [1:7] 9038557 9038558 9038559 9038560 9038561 ...
#>   ..$ Family   : chr [1:7] "Telemidae" "Telemidae" "Telemidae" "Telemidae" ...
#>   ..$ Genus    : chr [1:7] "Usofila" "Usofila" "Usofila" "Usofila" ...
#>   ..$ Country  : chr [1:7] "USA" "USA" "USA" "USA" ...
#>   ..$ State    : chr [1:7] "California" "California" "California" "California" ...
#>   ..$ County   : chr [1:7] "Contra Costa" "Contra Costa" "Contra Costa" "Contra Costa" ...
#>   ..$ Locality : chr [1:7] "Mt. Diablo, N. Gate Rd." "Mt. Diablo, N. Gate Rd." "Mt. Diablo, N. Gate Rd." "Orinda (1 Mi. W.)" ...
#>   ..$ Date     : chr [1:7] "22/2/1991" "22/2/1991" "22/2/1991" "12/12/1953" ...
#>   ..$ Collector: chr [1:7] "D Ubick" "D Ubick" "D Ubick" "V Roth" ...
#>   ..- attr(*, "spec")=
#>   .. .. cols(
#>   .. ..   Accession = col_double(),
#>   .. ..   Family = col_character(),
#>   .. ..   Genus = col_character(),
#>   .. ..   Country = col_character(),
#>   .. ..   State = col_character(),
#>   .. ..   County = col_character(),
#>   .. ..   Locality = col_character(),
#>   .. ..   Date = col_character(),
#>   .. ..   Collector = col_character()
#>   .. .. )
#>   ..- attr(*, "problems")=<externalptr> 
#>  $ : spc_tbl_ [3 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
#>   ..$ Accession: num [1:3] 9038519 9038520 9038784
#>   ..$ Family   : chr [1:3] "Telemidae" "Telemidae" "Telemidae"
#>   ..$ Genus    : chr [1:3] "Usofila" "Usofila" "Usofila"
#>   ..$ Country  : chr [1:3] "USA" "USA" "USA"
#>   ..$ State    : chr [1:3] "California" "California" "California"
#>   ..$ County   : chr [1:3] "Del Norte" "Del Norte" "Del Norte"
#>   ..$ Locality : chr [1:3] "18mS Klamath" "18mS Klamath" "Jedediah Smith Redwoods State Park"
#>   ..$ Date     : chr [1:3] "19/9/1953" "19/9/1953" "20/4/1994"
#>   ..$ Collector: chr [1:3] "Gilbert-Schuster" "Gilbert-Schuster" "LJ Boutin"
#>   ..- attr(*, "spec")=
#>   .. .. cols(
#>   .. ..   Accession = col_double(),
#>   .. ..   Family = col_character(),
#>   .. ..   Genus = col_character(),
#>   .. ..   Country = col_character(),
#>   .. ..   State = col_character(),
#>   .. ..   County = col_character(),
#>   .. ..   Locality = col_character(),
#>   .. ..   Date = col_character(),
#>   .. ..   Collector = col_character()
#>   .. .. )
#>   ..- attr(*, "problems")=<externalptr> 
#>  $ : spc_tbl_ [9 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
#>   ..$ Accession: num [1:9] 9038563 9038564 9038565 9038566 9038568 ...
#>   ..$ Family   : chr [1:9] "Telemidae" "Telemidae" "Telemidae" "Telemidae" ...
#>   ..$ Genus    : chr [1:9] "Usofila" "Usofila" "Usofila" "Usofila" ...
#>   ..$ Country  : chr [1:9] "USA" "USA" "USA" "USA" ...
#>   ..$ State    : chr [1:9] "California" "California" "California" "California" ...
#>   ..$ County   : chr [1:9] "El Dorado" "El Dorado" "El Dorado" "El Dorado" ...
#>   ..$ Locality : chr [1:9] "3 mi N Placerville" "Alabaster Cave" "Alabaster Cave" "Alabaster Cave" ...
#>   ..$ Date     : chr [1:9] "18/5/1961" "1/9/1962" "1/9/1962" "18/3/1946" ...
#>   ..$ Collector: chr [1:9] "RO Schuster" "L Readdy" "L Readdy" "Marx" ...
#>   ..- attr(*, "spec")=
#>   .. .. cols(
#>   .. ..   Accession = col_double(),
#>   .. ..   Family = col_character(),
#>   .. ..   Genus = col_character(),
#>   .. ..   Country = col_character(),
#>   .. ..   State = col_character(),
#>   .. ..   County = col_character(),
#>   .. ..   Locality = col_character(),
#>   .. ..   Date = col_character(),
#>   .. ..   Collector = col_character()
#>   .. .. )
#>   ..- attr(*, "problems")=<externalptr> 
#>  $ : spc_tbl_ [10 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
#>   ..$ Accession: num [1:10] 9038573 9038574 9038575 9038576 9038577 ...
#>   ..$ Family   : chr [1:10] "Telemidae" "Telemidae" "Telemidae" "Telemidae" ...
#>   ..$ Genus    : chr [1:10] "Usofila" "Usofila" "Usofila" "Usofila" ...
#>   ..$ Country  : chr [1:10] "USA" "USA" "USA" "USA" ...
#>   ..$ State    : chr [1:10] "California" "California" "California" "California" ...
#>   ..$ County   : chr [1:10] "Humboldt" "Humboldt" "Humboldt" "Humboldt" ...
#>   ..$ Locality : chr [1:10] "18 mi S Klamath" "18 mi S Klamath" "Orick" "14 mi. E. of Blue Lake" ...
#>   ..$ Date     : chr [1:10] "13/8/1953" "13/8/1953" "16/9/1961" "19/9/1953" ...
#>   ..$ Collector: chr [1:10] "GA Marsh, RO Schuster" "GA Marsh, RO Schuster" "W Ivie, WJ Gertsch" "R Schuster" ...
#>   ..- attr(*, "spec")=
#>   .. .. cols(
#>   .. ..   Accession = col_double(),
#>   .. ..   Family = col_character(),
#>   .. ..   Genus = col_character(),
#>   .. ..   Country = col_character(),
#>   .. ..   State = col_character(),
#>   .. ..   County = col_character(),
#>   .. ..   Locality = col_character(),
#>   .. ..   Date = col_character(),
#>   .. ..   Collector = col_character()
#>   .. .. )
#>   ..- attr(*, "problems")=<externalptr> 
#>  $ : spc_tbl_ [1 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
#>   ..$ Accession: num 9038542
#>   ..$ Family   : chr "Telemidae"
#>   ..$ Genus    : chr "Usofila"
#>   ..$ Country  : chr "USA"
#>   ..$ State    : chr "California"
#>   ..$ County   : chr "Kern"
#>   ..$ Locality : chr "Bodfish, Harrington Cave"
#>   ..$ Date     : chr "30/9/1980"
#>   ..$ Collector: chr "TS Briggs"
#>   ..- attr(*, "spec")=
#>   .. .. cols(
#>   .. ..   Accession = col_double(),
#>   .. ..   Family = col_character(),
#>   .. ..   Genus = col_character(),
#>   .. ..   Country = col_character(),
#>   .. ..   State = col_character(),
#>   .. ..   County = col_character(),
#>   .. ..   Locality = col_character(),
#>   .. ..   Date = col_character(),
#>   .. ..   Collector = col_character()
#>   .. .. )
#>   ..- attr(*, "problems")=<externalptr> 
#>  $ : spc_tbl_ [20 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
#>   ..$ Accession: num [1:20] 9038704 9038705 9038706 9038707 9038708 ...
#>   ..$ Family   : chr [1:20] "Telemidae" "Telemidae" "Telemidae" "Telemidae" ...
#>   ..$ Genus    : chr [1:20] "Usofila" "Usofila" "Usofila" "Usofila" ...
#>   ..$ Country  : chr [1:20] "USA" "USA" "USA" "USA" ...
#>   ..$ State    : chr [1:20] "California" "California" "California" "California" ...
#>   ..$ County   : chr [1:20] "Marin" "Marin" "Marin" "Marin" ...
#>   ..$ Locality : chr [1:20] "6 mi E Point Reyes Sta" "Novato, San Marin Dr." "Black Point" "Ross Bald Hill" ...
#>   ..$ Date     : chr [1:20] "1/3/1960" "14/3/1982" "24/3/1960" "01/3/1991" ...
#>   ..$ Collector: chr [1:20] "Grigarick, Smith, Schuster" "D Ubick" "RO Schuster" "D Ubick, T Briggs" ...
#>   ..- attr(*, "spec")=
#>   .. .. cols(
#>   .. ..   Accession = col_double(),
#>   .. ..   Family = col_character(),
#>   .. ..   Genus = col_character(),
#>   .. ..   Country = col_character(),
#>   .. ..   State = col_character(),
#>   .. ..   County = col_character(),
#>   .. ..   Locality = col_character(),
#>   .. ..   Date = col_character(),
#>   .. ..   Collector = col_character()
#>   .. .. )
#>   ..- attr(*, "problems")=<externalptr> 
#>  $ : spc_tbl_ [5 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
#>   ..$ Accession: num [1:5] 9038581 9038582 9038583 9038584 9038585
#>   ..$ Family   : chr [1:5] "Telemidae" "Telemidae" "Telemidae" "Telemidae" ...
#>   ..$ Genus    : chr [1:5] "Usofila" "Usofila" "Usofila" "Usofila" ...
#>   ..$ Country  : chr [1:5] "USA" "USA" "USA" "USA" ...
#>   ..$ State    : chr [1:5] "California" "California" "California" "California" ...
#>   ..$ County   : chr [1:5] "Mariposa" "Mariposa" "Mariposa" "Mariposa" ...
#>   ..$ Locality : chr [1:5] "Bull Creek Cave, 11 mi. E of Coulterville" "6 mi S Mather" "Mariposa" "Mariposa" ...
#>   ..$ Date     : chr [1:5] "7/4/1979" "4/9/1958" "4/4/1953" "4/4/1953" ...
#>   ..$ Collector: chr [1:5] "DC Rudolph, B Martin, S Winterath, D Cowan, T Lakner" "V Roth" "R Schuster" "R Schuster" ...
#>   ..- attr(*, "spec")=
#>   .. .. cols(
#>   .. ..   Accession = col_double(),
#>   .. ..   Family = col_character(),
#>   .. ..   Genus = col_character(),
#>   .. ..   Country = col_character(),
#>   .. ..   State = col_character(),
#>   .. ..   County = col_character(),
#>   .. ..   Locality = col_character(),
#>   .. ..   Date = col_character(),
#>   .. ..   Collector = col_character()
#>   .. .. )
#>   ..- attr(*, "problems")=<externalptr> 
#>  $ : spc_tbl_ [16 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
#>   ..$ Accession: num [1:16] 9038586 9038587 9038588 9038589 9038590 ...
#>   ..$ Family   : chr [1:16] "Telemidae" "Telemidae" "Telemidae" "Telemidae" ...
#>   ..$ Genus    : chr [1:16] "Usofila" "Usofila" "Usofila" "Usofila" ...
#>   ..$ Country  : chr [1:16] "USA" "USA" "USA" "USA" ...
#>   ..$ State    : chr [1:16] "California" "California" "California" "California" ...
#>   ..$ County   : chr [1:16] "Mendocino" "Mendocino" "Mendocino" "Mendocino" ...
#>   ..$ Locality : chr [1:16] "Jackson State Forest: Dunlap Camp 400'" "Jackson State Forest: Dunlap Camp 400'" "Jackson State Forest: Big River, 0.5 mi E Big R. Camp" "Spyrock Road, 9.2 mi NE Hwy 101 (2100')" ...
#>   ..$ Date     : chr [1:16] "7/9/1992" "25/7/1993" "15/9/1990" "21/9/1990" ...
#>   ..$ Collector: chr [1:16] "D Ubick, J Boutin" "D Ubick" "D Ubick" "D Ubick" ...
#>   ..- attr(*, "spec")=
#>   .. .. cols(
#>   .. ..   Accession = col_double(),
#>   .. ..   Family = col_character(),
#>   .. ..   Genus = col_character(),
#>   .. ..   Country = col_character(),
#>   .. ..   State = col_character(),
#>   .. ..   County = col_character(),
#>   .. ..   Locality = col_character(),
#>   .. ..   Date = col_character(),
#>   .. ..   Collector = col_character()
#>   .. .. )
#>   ..- attr(*, "problems")=<externalptr> 
#>  $ : spc_tbl_ [2 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
#>   ..$ Accession: num [1:2] 9038781 9038601
#>   ..$ Family   : chr [1:2] "Telemidae" "Telemidae"
#>   ..$ Genus    : chr [1:2] "Usofila" "Usofila"
#>   ..$ Country  : chr [1:2] "USA" "USA"
#>   ..$ State    : chr [1:2] "California" "California"
#>   ..$ County   : chr [1:2] "Monterey" "Monterey"
#>   ..$ Locality : chr [1:2] "Pfeiffer, Big Sur State Park" "Limekiln Creek"
#>   ..$ Date     : chr [1:2] "2/5/1964" "31/5/1991"
#>   ..$ Collector: chr [1:2] "PR & DL Craig" "D Ubick"
#>   ..- attr(*, "spec")=
#>   .. .. cols(
#>   .. ..   Accession = col_double(),
#>   .. ..   Family = col_character(),
#>   .. ..   Genus = col_character(),
#>   .. ..   Country = col_character(),
#>   .. ..   State = col_character(),
#>   .. ..   County = col_character(),
#>   .. ..   Locality = col_character(),
#>   .. ..   Date = col_character(),
#>   .. ..   Collector = col_character()
#>   .. .. )
#>   ..- attr(*, "problems")=<externalptr> 
#>  $ : spc_tbl_ [21 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
#>   ..$ Accession: num [1:21] 9038602 9038603 9038604 9038605 9038606 ...
#>   ..$ Family   : chr [1:21] "Telemidae" "Telemidae" "Telemidae" "Telemidae" ...
#>   ..$ Genus    : chr [1:21] "Usofila" "Usofila" "Usofila" "Usofila" ...
#>   ..$ Country  : chr [1:21] "USA" "USA" "USA" "USA" ...
#>   ..$ State    : chr [1:21] "California" "California" "California" "California" ...
#>   ..$ County   : chr [1:21] "Napa" "Napa" "Napa" "Napa" ...
#>   ..$ Locality : chr [1:21] "Mt. St. Helena" "Mt. St. Helena" "9 mi S of Monticello" "5 mi S of Monticello" ...
#>   ..$ Date     : chr [1:21] "30/5/1949" "31/12/1953" "19/1/1958" "6/1/1957" ...
#>   ..$ Collector: chr [1:21] "EI Schlinger" "G Marsh, R Schuster, V Roth" "RO Schuster" "RO Schuster" ...
#>   ..- attr(*, "spec")=
#>   .. .. cols(
#>   .. ..   Accession = col_double(),
#>   .. ..   Family = col_character(),
#>   .. ..   Genus = col_character(),
#>   .. ..   Country = col_character(),
#>   .. ..   State = col_character(),
#>   .. ..   County = col_character(),
#>   .. ..   Locality = col_character(),
#>   .. ..   Date = col_character(),
#>   .. ..   Collector = col_character()
#>   .. .. )
#>   ..- attr(*, "problems")=<externalptr> 
#>  $ : spc_tbl_ [8 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
#>   ..$ Accession: num [1:8] 9038500 9038501 9038502 9038503 9038504 ...
#>   ..$ Family   : chr [1:8] "Telemidae" "Telemidae" "Telemidae" "Telemidae" ...
#>   ..$ Genus    : chr [1:8] "Usofila" "Usofila" "Usofila" "Usofila" ...
#>   ..$ Country  : chr [1:8] "USA" "USA" "USA" "USA" ...
#>   ..$ State    : chr [1:8] "California" "California" "California" "California" ...
#>   ..$ County   : chr [1:8] "Placer" "Placer" "Placer" "Placer" ...
#>   ..$ Locality : chr [1:8] "4mW Newcastle" "4mW Newcastle" "4mW Newcastle" "4mW Newcastle" ...
#>   ..$ Date     : chr [1:8] "10/3/1959" "3/1/1959" "10/3/1959" "21/3/1958" ...
#>   ..$ Collector: chr [1:8] "LM Smith, RO Schuster" "F Raney, RO Schuster" "LM Smith, RO Schuster" "H Lange, LM Smith, RO Schuster" ...
#>   ..- attr(*, "spec")=
#>   .. .. cols(
#>   .. ..   Accession = col_double(),
#>   .. ..   Family = col_character(),
#>   .. ..   Genus = col_character(),
#>   .. ..   Country = col_character(),
#>   .. ..   State = col_character(),
#>   .. ..   County = col_character(),
#>   .. ..   Locality = col_character(),
#>   .. ..   Date = col_character(),
#>   .. ..   Collector = col_character()
#>   .. .. )
#>   ..- attr(*, "problems")=<externalptr> 
#>  $ : spc_tbl_ [2 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
#>   ..$ Accession: num [1:2] 9038515 9038517
#>   ..$ Family   : chr [1:2] "Telemidae" "Telemidae"
#>   ..$ Genus    : chr [1:2] "Usofila" "Usofila"
#>   ..$ Country  : chr [1:2] "USA" "USA"
#>   ..$ State    : chr [1:2] "California" "California"
#>   ..$ County   : chr [1:2] "Plumas" "Plumas"
#>   ..$ Locality : chr [1:2] "Juniper Cave, WSI #C-96, C-103 and C-105, 10 mi SE Quincy" "Soda Springs Cave"
#>   ..$ Date     : chr [1:2] "19/9/1959" "5/9/1961"
#>   ..$ Collector: chr [1:2] "R Graham" "R Graham"
#>   ..- attr(*, "spec")=
#>   .. .. cols(
#>   .. ..   Accession = col_double(),
#>   .. ..   Family = col_character(),
#>   .. ..   Genus = col_character(),
#>   .. ..   Country = col_character(),
#>   .. ..   State = col_character(),
#>   .. ..   County = col_character(),
#>   .. ..   Locality = col_character(),
#>   .. ..   Date = col_character(),
#>   .. ..   Collector = col_character()
#>   .. .. )
#>   ..- attr(*, "problems")=<externalptr> 
#>  $ : spc_tbl_ [1 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
#>   ..$ Accession: num 9038518
#>   ..$ Family   : chr "Telemidae"
#>   ..$ Genus    : chr "Usofila"
#>   ..$ Country  : chr "USA"
#>   ..$ State    : chr "California"
#>   ..$ County   : chr "San Bernandino"
#>   ..$ Locality : chr "Crystal Kokoweah Cave nr. Mtn. Pass"
#>   ..$ Date     : chr "1/4/1972"
#>   ..$ Collector: chr "TS Briggs"
#>   ..- attr(*, "spec")=
#>   .. .. cols(
#>   .. ..   Accession = col_double(),
#>   .. ..   Family = col_character(),
#>   .. ..   Genus = col_character(),
#>   .. ..   Country = col_character(),
#>   .. ..   State = col_character(),
#>   .. ..   County = col_character(),
#>   .. ..   Locality = col_character(),
#>   .. ..   Date = col_character(),
#>   .. ..   Collector = col_character()
#>   .. .. )
#>   ..- attr(*, "problems")=<externalptr> 
#>  $ : spc_tbl_ [1 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
#>   ..$ Accession: num 9038511
#>   ..$ Family   : chr "Telemidae"
#>   ..$ Genus    : chr "Usofila"
#>   ..$ Country  : chr "USA"
#>   ..$ State    : chr "California"
#>   ..$ County   : chr "San Francisco"
#>   ..$ Locality : chr "SF Golden State Park"
#>   ..$ Date     : chr "10/2/1954"
#>   ..$ Collector: chr "R Schuster"
#>   ..- attr(*, "spec")=
#>   .. .. cols(
#>   .. ..   Accession = col_double(),
#>   .. ..   Family = col_character(),
#>   .. ..   Genus = col_character(),
#>   .. ..   Country = col_character(),
#>   .. ..   State = col_character(),
#>   .. ..   County = col_character(),
#>   .. ..   Locality = col_character(),
#>   .. ..   Date = col_character(),
#>   .. ..   Collector = col_character()
#>   .. .. )
#>   ..- attr(*, "problems")=<externalptr> 
#>  $ : spc_tbl_ [7 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
#>   ..$ Accession: num [1:7] 9038553 9038554 9038555 9038556 9038770 ...
#>   ..$ Family   : chr [1:7] "Telemidae" "Telemidae" "Telemidae" "Telemidae" ...
#>   ..$ Genus    : chr [1:7] "Usofila" "Usofila" "Usofila" "Usofila" ...
#>   ..$ Country  : chr [1:7] "USA" "USA" "USA" "USA" ...
#>   ..$ State    : chr [1:7] "California" "California" "California" "California" ...
#>   ..$ County   : chr [1:7] "San Mateo" "San Mateo" "San Mateo" "San Mateo" ...
#>   ..$ Locality : chr [1:7] "1 mi S La Honda" "Alpine Road, 0.5 mi SE Pescadero Rd." "E end Purisima Ck. Redwoods Open Space" "Scarper Peak Road, 1.3 mi SE El Granada-Pilarcitos Lake Rd." ...
#>   ..$ Date     : chr [1:7] "29/6/1990" "18/11/1988" "16/5/1991" "13/7/2001" ...
#>   ..$ Collector: chr [1:7] "D Ubick" "D Ubick" "D Ubick" "TS Briggs, D + S Ubick" ...
#>   ..- attr(*, "spec")=
#>   .. .. cols(
#>   .. ..   Accession = col_double(),
#>   .. ..   Family = col_character(),
#>   .. ..   Genus = col_character(),
#>   .. ..   Country = col_character(),
#>   .. ..   State = col_character(),
#>   .. ..   County = col_character(),
#>   .. ..   Locality = col_character(),
#>   .. ..   Date = col_character(),
#>   .. ..   Collector = col_character()
#>   .. .. )
#>   ..- attr(*, "problems")=<externalptr> 
#>  $ : spc_tbl_ [8 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
#>   ..$ Accession: num [1:8] 9038624 9038625 9038626 9038627 9038628 ...
#>   ..$ Family   : chr [1:8] "Telemidae" "Telemidae" "Telemidae" "Telemidae" ...
#>   ..$ Genus    : chr [1:8] "Usofila" "Usofila" "Usofila" "Usofila" ...
#>   ..$ Country  : chr [1:8] "USA" "USA" "USA" "USA" ...
#>   ..$ State    : chr [1:8] "California" "California" "California" "California" ...
#>   ..$ County   : chr [1:8] "Santa Clara" "Santa Clara" "Santa Clara" "Santa Clara" ...
#>   ..$ Locality : chr [1:8] "9.0 mi N Bell Station" "Henry Coe St. Pk: midway bet Manzanita Pt. Group Comp and Madrone Soda Spr." "Henry Coe St. Pk: 9.2 mi N Bell Station: N Fork Pacheco Ck" "Santa Teresa County Park, Serpentine Grassland" ...
#>   ..$ Date     : chr [1:8] "10/2/1991" "11/3/1989" "31/3/1989" "20/2/1989" ...
#>   ..$ Collector: chr [1:8] "D Ubick" "D Ubick" "D Ubick" "D Ubick" ...
#>   ..- attr(*, "spec")=
#>   .. .. cols(
#>   .. ..   Accession = col_double(),
#>   .. ..   Family = col_character(),
#>   .. ..   Genus = col_character(),
#>   .. ..   Country = col_character(),
#>   .. ..   State = col_character(),
#>   .. ..   County = col_character(),
#>   .. ..   Locality = col_character(),
#>   .. ..   Date = col_character(),
#>   .. ..   Collector = col_character()
#>   .. .. )
#>   ..- attr(*, "problems")=<externalptr> 
#>  $ : spc_tbl_ [8 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
#>   ..$ Accession: num [1:8] 9038543 9038544 9038545 9038546 9034549 ...
#>   ..$ Family   : chr [1:8] "Telemidae" "Telemidae" "Telemidae" "Telemidae" ...
#>   ..$ Genus    : chr [1:8] "Usofila" "Usofila" "Usofila" "Usofila" ...
#>   ..$ Country  : chr [1:8] "USA" "USA" "USA" "USA" ...
#>   ..$ State    : chr [1:8] "California" "California" "California" "California" ...
#>   ..$ County   : chr [1:8] "Santa Cruz" "Santa Cruz" "Santa Cruz" "Santa Cruz" ...
#>   ..$ Locality : chr [1:8] "6mNE Boulder Cr." "Big Basin" "Boulder Creek" "Cave Gulch at Empire Grade Rd." ...
#>   ..$ Date     : chr [1:8] "28/8/1957" "14/6/1953" "23/12/1953" "18/2/1991" ...
#>   ..$ Collector: chr [1:8] "I Newell" "PP Cook" "V Roth" "D Ubick" ...
#>   ..- attr(*, "spec")=
#>   .. .. cols(
#>   .. ..   Accession = col_double(),
#>   .. ..   Family = col_character(),
#>   .. ..   Genus = col_character(),
#>   .. ..   Country = col_character(),
#>   .. ..   State = col_character(),
#>   .. ..   County = col_character(),
#>   .. ..   Locality = col_character(),
#>   .. ..   Date = col_character(),
#>   .. ..   Collector = col_character()
#>   .. .. )
#>   ..- attr(*, "problems")=<externalptr> 
#>  $ : spc_tbl_ [21 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
#>   ..$ Accession: num [1:21] 9038682 9038683 9038685 9038686 9038687 ...
#>   ..$ Family   : chr [1:21] "Telemidae" "Telemidae" "Telemidae" "Telemidae" ...
#>   ..$ Genus    : chr [1:21] "Usofila" "Usofila" "Usofila" "Usofila" ...
#>   ..$ Country  : chr [1:21] "USA" "USA" "USA" "USA" ...
#>   ..$ State    : chr [1:21] "California" "California" "California" "California" ...
#>   ..$ County   : chr [1:21] "Shasta" "Shasta" "Shasta" "Shasta" ...
#>   ..$ Locality : chr [1:21] "Samwel Cave, 7 mi S Point McCloud Resort, Shasta Lake" "8 mi S Dunsmuir" "Samwell Cave, 25 mi N Redding" "Potter Creek Cave" ...
#>   ..$ Date     : chr [1:21] "15/9/1961" "11/7/1954" "9/4/1979" "7/9/1961" ...
#>   ..$ Collector: chr [1:21] "R Graham" "R Schuster, E Gilbert" "Rudolph, Martin, Winterath" "R Graham" ...
#>   ..- attr(*, "spec")=
#>   .. .. cols(
#>   .. ..   Accession = col_double(),
#>   .. ..   Family = col_character(),
#>   .. ..   Genus = col_character(),
#>   .. ..   Country = col_character(),
#>   .. ..   State = col_character(),
#>   .. ..   County = col_character(),
#>   .. ..   Locality = col_character(),
#>   .. ..   Date = col_character(),
#>   .. ..   Collector = col_character()
#>   .. .. )
#>   ..- attr(*, "problems")=<externalptr> 
#>  $ : spc_tbl_ [1 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
#>   ..$ Accession: num 9038538
#>   ..$ Family   : chr "Telemidae"
#>   ..$ Genus    : chr "Usofila"
#>   ..$ Country  : chr "USA"
#>   ..$ State    : chr "California"
#>   ..$ County   : chr "Sierra"
#>   ..$ Locality : chr "Big Springs, 3 mi E Sierra City"
#>   ..$ Date     : chr "17/8/1991"
#>   ..$ Collector: chr "D Ubick"
#>   ..- attr(*, "spec")=
#>   .. .. cols(
#>   .. ..   Accession = col_double(),
#>   .. ..   Family = col_character(),
#>   .. ..   Genus = col_character(),
#>   .. ..   Country = col_character(),
#>   .. ..   State = col_character(),
#>   .. ..   County = col_character(),
#>   .. ..   Locality = col_character(),
#>   .. ..   Date = col_character(),
#>   .. ..   Collector = col_character()
#>   .. .. )
#>   ..- attr(*, "problems")=<externalptr> 
#>  $ : spc_tbl_ [2 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
#>   ..$ Accession: num [1:2] 9038512 9038513
#>   ..$ Family   : chr [1:2] "Telemidae" "Telemidae"
#>   ..$ Genus    : chr [1:2] "Usofila" "Usofila"
#>   ..$ Country  : chr [1:2] "USA" "USA"
#>   ..$ State    : chr [1:2] "California" "California"
#>   ..$ County   : chr [1:2] "Siskiyou" "Siskiyou"
#>   ..$ Locality : chr [1:2] "1 mi S of Somes Bar" "3.5 air mi W Gazelle, True Shasta View Cave"
#>   ..$ Date     : chr [1:2] "22/8/1959" "17/6/1989"
#>   ..$ Collector: chr [1:2] "V Roth, WJ Gertsch" "D Ubick"
#>   ..- attr(*, "spec")=
#>   .. .. cols(
#>   .. ..   Accession = col_double(),
#>   .. ..   Family = col_character(),
#>   .. ..   Genus = col_character(),
#>   .. ..   Country = col_character(),
#>   .. ..   State = col_character(),
#>   .. ..   County = col_character(),
#>   .. ..   Locality = col_character(),
#>   .. ..   Date = col_character(),
#>   .. ..   Collector = col_character()
#>   .. .. )
#>   ..- attr(*, "problems")=<externalptr> 
#>  $ : spc_tbl_ [1 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
#>   ..$ Accession: num 9038541
#>   ..$ Family   : chr "Telemidae"
#>   ..$ Genus    : chr "Usofila"
#>   ..$ Country  : chr "USA"
#>   ..$ State    : chr "California"
#>   ..$ County   : chr "Solano"
#>   ..$ Locality : chr "1mW Cordelia"
#>   ..$ Date     : chr "11/2/1960"
#>   ..$ Collector: chr "FC Raney"
#>   ..- attr(*, "spec")=
#>   .. .. cols(
#>   .. ..   Accession = col_double(),
#>   .. ..   Family = col_character(),
#>   .. ..   Genus = col_character(),
#>   .. ..   Country = col_character(),
#>   .. ..   State = col_character(),
#>   .. ..   County = col_character(),
#>   .. ..   Locality = col_character(),
#>   .. ..   Date = col_character(),
#>   .. ..   Collector = col_character()
#>   .. .. )
#>   ..- attr(*, "problems")=<externalptr> 
#>  $ : spc_tbl_ [11 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
#>   ..$ Accession: num [1:11] 9038630 9038631 9038632 9038633 9038634 ...
#>   ..$ Family   : chr [1:11] "Telemidae" "Telemidae" "Telemidae" "Telemidae" ...
#>   ..$ Genus    : chr [1:11] "Usofila" "Usofila" "Usofila" "Usofila" ...
#>   ..$ Country  : chr [1:11] "USA" "USA" "USA" "USA" ...
#>   ..$ State    : chr [1:11] "California" "California" "California" "California" ...
#>   ..$ County   : chr [1:11] "Sonoma" "Sonoma" "Sonoma" "Sonoma" ...
#>   ..$ Locality : chr [1:11] "Sonoma Mtn., Carriger Ck. At Canyon Dr." "2.5 mi E. Healdsburg" "Canyon Drive, Deer Park Drive, 3.5 mi W. of El Verano" "nr. El Verano Jct. Spring and Prospect Rds. at Diamond Estates Rec. Area" ...
#>   ..$ Date     : chr [1:11] "11/2/1983" "07/12/1980" "11/2/1983" "18/1/1988" ...
#>   ..$ Collector: chr [1:11] "TS Briggs, D Ubick, V F Lee" "D Ubick" "TS Briggs, D Ubick, V F Lee" "T Briggs" ...
#>   ..- attr(*, "spec")=
#>   .. .. cols(
#>   .. ..   Accession = col_double(),
#>   .. ..   Family = col_character(),
#>   .. ..   Genus = col_character(),
#>   .. ..   Country = col_character(),
#>   .. ..   State = col_character(),
#>   .. ..   County = col_character(),
#>   .. ..   Locality = col_character(),
#>   .. ..   Date = col_character(),
#>   .. ..   Collector = col_character()
#>   .. .. )
#>   ..- attr(*, "problems")=<externalptr> 
#>  $ : spc_tbl_ [2 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
#>   ..$ Accession: num [1:2] 9038539 9038540
#>   ..$ Family   : chr [1:2] "Telemidae" "Telemidae"
#>   ..$ Genus    : chr [1:2] "Usofila" "Usofila"
#>   ..$ Country  : chr [1:2] "USA" "USA"
#>   ..$ State    : chr [1:2] "California" "California"
#>   ..$ County   : chr [1:2] "Stanislaus" "Stanislaus"
#>   ..$ Locality : chr [1:2] "17.8 mi N Bell Station" "Henry Coe St. Pk: 15.0 mi N Bell Station: S Fork Orestimba Ck"
#>   ..$ Date     : chr [1:2] "10/2/1991" "31/3/1989"
#>   ..$ Collector: chr [1:2] "D Ubick" "D Ubick"
#>   ..- attr(*, "spec")=
#>   .. .. cols(
#>   .. ..   Accession = col_double(),
#>   .. ..   Family = col_character(),
#>   .. ..   Genus = col_character(),
#>   .. ..   Country = col_character(),
#>   .. ..   State = col_character(),
#>   .. ..   County = col_character(),
#>   .. ..   Locality = col_character(),
#>   .. ..   Date = col_character(),
#>   .. ..   Collector = col_character()
#>   .. .. )
#>   ..- attr(*, "problems")=<externalptr> 
#>  $ : spc_tbl_ [1 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
#>   ..$ Accession: num 9038510
#>   ..$ Family   : chr "Telemidae"
#>   ..$ Genus    : chr "Usofila"
#>   ..$ Country  : chr "USA"
#>   ..$ State    : chr "California"
#>   ..$ County   : chr "Tehama"
#>   ..$ Locality : chr "4 mi W Mineral"
#>   ..$ Date     : chr "26/6/1954"
#>   ..$ Collector: chr "R Schuster"
#>   ..- attr(*, "spec")=
#>   .. .. cols(
#>   .. ..   Accession = col_double(),
#>   .. ..   Family = col_character(),
#>   .. ..   Genus = col_character(),
#>   .. ..   Country = col_character(),
#>   .. ..   State = col_character(),
#>   .. ..   County = col_character(),
#>   .. ..   Locality = col_character(),
#>   .. ..   Date = col_character(),
#>   .. ..   Collector = col_character()
#>   .. .. )
#>   ..- attr(*, "problems")=<externalptr> 
#>  $ : spc_tbl_ [6 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
#>   ..$ Accession: num [1:6] 9038641 9038642 9038643 9038644 9038645 ...
#>   ..$ Family   : chr [1:6] "Telemidae" "Telemidae" "Telemidae" "Telemidae" ...
#>   ..$ Genus    : chr [1:6] "Usofila" "Usofila" "Usofila" "Usofila" ...
#>   ..$ Country  : chr [1:6] "USA" "USA" "USA" "USA" ...
#>   ..$ State    : chr [1:6] "California" "California" "California" "California" ...
#>   ..$ County   : chr [1:6] "Trinity" "Trinity" "Trinity" "Trinity" ...
#>   ..$ Locality : chr [1:6] "Indian Valley Ck., just E. of Cave" "Indian Valley Ck. Cave, 4 air mi SSE Hyampom" "Big Slide Cmpg., N of Hyampom" "Indian Valley Creek Cave" ...
#>   ..$ Date     : chr [1:6] "27/10/1990" "31/8/1996" "13/8/1990" "27/10/1990" ...
#>   ..$ Collector: chr [1:6] "D Ubick" "D Ubick" "D Ubick" "D Ubick, W Rauscher" ...
#>   ..- attr(*, "spec")=
#>   .. .. cols(
#>   .. ..   Accession = col_double(),
#>   .. ..   Family = col_character(),
#>   .. ..   Genus = col_character(),
#>   .. ..   Country = col_character(),
#>   .. ..   State = col_character(),
#>   .. ..   County = col_character(),
#>   .. ..   Locality = col_character(),
#>   .. ..   Date = col_character(),
#>   .. ..   Collector = col_character()
#>   .. .. )
#>   ..- attr(*, "problems")=<externalptr> 
#>  $ : spc_tbl_ [19 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
#>   ..$ Accession: num [1:19] 9038915 9038647 9038648 9038649 9038650 ...
#>   ..$ Family   : chr [1:19] "Telemidae" "Telemidae" "Telemidae" "Telemidae" ...
#>   ..$ Genus    : chr [1:19] "Usofila" "Usofila" "Usofila" "Usofila" ...
#>   ..$ Country  : chr [1:19] "USA" "USA" "USA" "USA" ...
#>   ..$ State    : chr [1:19] "California" "California" "California" "California" ...
#>   ..$ County   : chr [1:19] "Tulare" "Tulare" "Tulare" "Tulare" ...
#>   ..$ Locality : chr [1:19] "Sequoia Nat'l Park, Clough Cave" "Clough Cave, Ladder Room, Sequoia N. P." "Clough Cave, Sequoia N.P." "Clough Cave, 15 mi SE Three Rivers" ...
#>   ..$ Date     : chr [1:19] "22/6/2000" "5/4/1990" "5/4/1990" "18/4/1979" ...
#>   ..$ Collector: chr [1:19] "JM Ledford, J Despaine" "Tyson, Brigman, Jeffery" "Tyson, Brigman, Jeffery" "Rudolph, vanIngen" ...
#>   ..- attr(*, "spec")=
#>   .. .. cols(
#>   .. ..   Accession = col_double(),
#>   .. ..   Family = col_character(),
#>   .. ..   Genus = col_character(),
#>   .. ..   Country = col_character(),
#>   .. ..   State = col_character(),
#>   .. ..   County = col_character(),
#>   .. ..   Locality = col_character(),
#>   .. ..   Date = col_character(),
#>   .. ..   Collector = col_character()
#>   .. .. )
#>   ..- attr(*, "problems")=<externalptr> 
#>  $ : spc_tbl_ [18 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
#>   ..$ Accession: num [1:18] 9038655 9038664 9038665 9038666 9038667 ...
#>   ..$ Family   : chr [1:18] "Telemidae" "Telemidae" "Telemidae" "Telemidae" ...
#>   ..$ Genus    : chr [1:18] "Usofila" "Usofila" "Usofila" "Usofila" ...
#>   ..$ Country  : chr [1:18] "USA" "USA" "USA" "USA" ...
#>   ..$ State    : chr [1:18] "California" "California" "California" "California" ...
#>   ..$ County   : chr [1:18] "Tuolumne" "Tuolumne" "Tuolumne" "Tuolumne" ...
#>   ..$ Locality : chr [1:18] "Pinnacle Point Cave, 16.7 km N Sonora" "Pinnacle Point Cave, 10 mi NE Angels Camp" "Stanislaus Canyon" "McLean's Cave,WSI #C-146, 4.6 km NNW Columbia" ...
#>   ..$ Date     : chr [1:18] "20/1/1978" "1/5/1977" "28/3/1979" "18/12/1977" ...
#>   ..$ Collector: chr [1:18] "WR Elliott, AG Grubbs, SA Winterath" "AG Grubbs, J Davis, N Boice, McEachprn" "J Reddell" "AG Grubbs, SA Winterath" ...
#>   ..- attr(*, "spec")=
#>   .. .. cols(
#>   .. ..   Accession = col_double(),
#>   .. ..   Family = col_character(),
#>   .. ..   Genus = col_character(),
#>   .. ..   Country = col_character(),
#>   .. ..   State = col_character(),
#>   .. ..   County = col_character(),
#>   .. ..   Locality = col_character(),
#>   .. ..   Date = col_character(),
#>   .. ..   Collector = col_character()
#>   .. .. )
#>   ..- attr(*, "problems")=<externalptr> 
#>  $ : spc_tbl_ [1 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
#>   ..$ Accession: num 9038508
#>   ..$ Family   : chr "Telemidae"
#>   ..$ Genus    : chr "Usofila"
#>   ..$ Country  : chr "USA"
#>   ..$ State    : chr "California"
#>   ..$ County   : chr "Yolo"
#>   ..$ Locality : chr "3miN Rumsey"
#>   ..$ Date     : chr "9/2/1960"
#>   ..$ Collector: chr "Smith, Schuster"
#>   ..- attr(*, "spec")=
#>   .. .. cols(
#>   .. ..   Accession = col_double(),
#>   .. ..   Family = col_character(),
#>   .. ..   Genus = col_character(),
#>   .. ..   Country = col_character(),
#>   .. ..   State = col_character(),
#>   .. ..   County = col_character(),
#>   .. ..   Locality = col_character(),
#>   .. ..   Date = col_character(),
#>   .. ..   Collector = col_character()
#>   .. .. )
#>   ..- attr(*, "problems")=<externalptr>
```



## Naming List Elements
We don't need to here, but for demonstration purposes we can name the elements in our list.  We want to keep the first element of each list element.

```r
names <- list.files(path = "data/spiders", pattern = ".csv")
names
#>  [1] "Alameda .csv"        "Amador .csv"         "Butte .csv"         
#>  [4] "Calaveras .csv"      "Contra Costa .csv"   "Del Norte .csv"     
#>  [7] "El Dorado .csv"      "Humboldt .csv"       "Kern .csv"          
#> [10] "Marin .csv"          "Mariposa .csv"       "Mendocino .csv"     
#> [13] "Monterey .csv"       "Napa .csv"           "Placer .csv"        
#> [16] "Plumas .csv"         "San Bernandino .csv" "San Francisco .csv" 
#> [19] "San Mateo .csv"      "Santa Clara .csv"    "Santa Cruz .csv"    
#> [22] "Shasta .csv"         "Sierra .csv"         "Siskiyou .csv"      
#> [25] "Solano .csv"         "Sonoma .csv"         "Stanislaus .csv"    
#> [28] "Tehama .csv"         "Trinity .csv"        "Tulare .csv"        
#> [31] "Tuolumne .csv"       "Yolo .csv"
```

We will first get the names of each file, but we only want the county part. We will use `strsplit()` for that, which creates a nested list of strings.

```r
names_list <- strsplit(names, split = " .csv")# list the names associated with that 
names_list
#> [[1]]
#> [1] "Alameda"
#> 
#> [[2]]
#> [1] "Amador"
#> 
#> [[3]]
#> [1] "Butte"
#> 
#> [[4]]
#> [1] "Calaveras"
#> 
#> [[5]]
#> [1] "Contra Costa"
#> 
#> [[6]]
#> [1] "Del Norte"
#> 
#> [[7]]
#> [1] "El Dorado"
#> 
#> [[8]]
#> [1] "Humboldt"
#> 
#> [[9]]
#> [1] "Kern"
#> 
#> [[10]]
#> [1] "Marin"
#> 
#> [[11]]
#> [1] "Mariposa"
#> 
#> [[12]]
#> [1] "Mendocino"
#> 
#> [[13]]
#> [1] "Monterey"
#> 
#> [[14]]
#> [1] "Napa"
#> 
#> [[15]]
#> [1] "Placer"
#> 
#> [[16]]
#> [1] "Plumas"
#> 
#> [[17]]
#> [1] "San Bernandino"
#> 
#> [[18]]
#> [1] "San Francisco"
#> 
#> [[19]]
#> [1] "San Mateo"
#> 
#> [[20]]
#> [1] "Santa Clara"
#> 
#> [[21]]
#> [1] "Santa Cruz"
#> 
#> [[22]]
#> [1] "Shasta"
#> 
#> [[23]]
#> [1] "Sierra"
#> 
#> [[24]]
#> [1] "Siskiyou"
#> 
#> [[25]]
#> [1] "Solano"
#> 
#> [[26]]
#> [1] "Sonoma"
#> 
#> [[27]]
#> [1] "Stanislaus"
#> 
#> [[28]]
#> [1] "Tehama"
#> 
#> [[29]]
#> [1] "Trinity"
#> 
#> [[30]]
#> [1] "Tulare"
#> 
#> [[31]]
#> [1] "Tuolumne"
#> 
#> [[32]]
#> [1] "Yolo"
```

We can then use `unlist()` to get a vector of the names.

```r
names_vec <- unlist(names_list)
names_vec
#>  [1] "Alameda"        "Amador"         "Butte"          "Calaveras"     
#>  [5] "Contra Costa"   "Del Norte"      "El Dorado"      "Humboldt"      
#>  [9] "Kern"           "Marin"          "Mariposa"       "Mendocino"     
#> [13] "Monterey"       "Napa"           "Placer"         "Plumas"        
#> [17] "San Bernandino" "San Francisco"  "San Mateo"      "Santa Clara"   
#> [21] "Santa Cruz"     "Shasta"         "Sierra"         "Siskiyou"      
#> [25] "Solano"         "Sonoma"         "Stanislaus"     "Tehama"        
#> [29] "Trinity"        "Tulare"         "Tuolumne"       "Yolo"
```

Now we can name the elements in our list.

```r
names(spider_list) <- names_vec
names(spider_list)
#>  [1] "Alameda"        "Amador"         "Butte"          "Calaveras"     
#>  [5] "Contra Costa"   "Del Norte"      "El Dorado"      "Humboldt"      
#>  [9] "Kern"           "Marin"          "Mariposa"       "Mendocino"     
#> [13] "Monterey"       "Napa"           "Placer"         "Plumas"        
#> [17] "San Bernandino" "San Francisco"  "San Mateo"      "Santa Clara"   
#> [21] "Santa Cruz"     "Shasta"         "Sierra"         "Siskiyou"      
#> [25] "Solano"         "Sonoma"         "Stanislaus"     "Tehama"        
#> [29] "Trinity"        "Tulare"         "Tuolumne"       "Yolo"
```

## Practice
1. Now that our list elements are named, how could we access the Butte County data by name?

```r
spider_list[["Butte"]]
#> # A tibble: 1 × 9
#>   Accession Family    Genus   Country State      County Locality Date  Collector
#>       <dbl> <chr>     <chr>   <chr>   <chr>      <chr>  <chr>    <chr> <chr>    
#> 1   9038509 Telemidae Usofila USA     California Butte  Dry Cre… 2/3/… RO Schus…
```

## Merging Files
We are fortunate here in that all of our data frames have the same column names. This makes it easy to merge the data together with `bind_rows()` from `dplyr`. `bind_rows()` matches columns by name.

```r
spiders_all <- bind_rows(spider_list)
spiders_all
#> # A tibble: 270 × 9
#>    Accession Family    Genus   Country State     County Locality Date  Collector
#>        <dbl> <chr>     <chr>   <chr>   <chr>     <chr>  <chr>    <chr> <chr>    
#>  1   9038521 Telemidae Usofila USA     Californ… Alame… Berkeley 2/3/… LM Smith 
#>  2   9038522 Telemidae Usofila USA     Californ… Alame… Castro … 24/3… WM Pearce
#>  3   9038523 Telemidae Usofila USA     Californ… Alame… Niles, … 2/1/… V Roth   
#>  4   9038524 Telemidae Usofila USA     Californ… Alame… Oakland  18/2… WG Benti…
#>  5   9038525 Telemidae Usofila USA     Californ… Alame… Oakland  25/1… R Schust…
#>  6   9038526 Telemidae Usofila USA     Californ… Alame… Oakland  18/2… WC Benti…
#>  7   9038527 Telemidae Usofila USA     Californ… Alame… Oakland  10/1… J Helfer 
#>  8  90386281 Telemidae Usofila USA     Californ… Alame… Oakland… 17/1… Roth, Sc…
#>  9   9038529 Telemidae Usofila USA     Californ… Alame… Oakland… 17/1… Roth, Sc…
#> 10  90387441 Telemidae Usofila USA     Californ… Alame… Berkele… 17/2… PR Craig…
#> # ℹ 260 more rows
```

## Joining Files
Sometimes data we need is stored in a separate file or becomes available later and we need to join it to our existing data in order to work with it. Let's use an easy example to explore some of the different types of joins. This section was based on the excellent example provided by [Holly Emblem](https://hollyemblem.medium.com/joining-data-with-dplyr-in-r-874698eb8898).  

Let's assume we have a database of customers and their purchases.

```r
table_A <- read_csv("data/table_A.csv")
#> Rows: 3 Columns: 5
#> ── Column specification ────────────────────────────────────────────────────────
#> Delimiter: ","
#> chr (1): last_order_date
#> dbl (4): customer_ID, n_orders, total_value_orders, ave_value_orders
#> 
#> ℹ Use `spec()` to retrieve the full column specification for this data.
#> ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
table_B <- read_csv("data/table_B.csv")
#> Rows: 3 Columns: 4
#> ── Column specification ────────────────────────────────────────────────────────
#> Delimiter: ","
#> chr (2): gender, favorite
#> dbl (2): customer_ID, age
#> 
#> ℹ Use `spec()` to retrieve the full column specification for this data.
#> ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
```


```r
table_A
#> # A tibble: 3 × 5
#>   customer_ID n_orders total_value_orders ave_value_orders last_order_date
#>         <dbl>    <dbl>              <dbl>            <dbl> <chr>          
#> 1           1        5                500              100 12/7/20        
#> 2           2       10                240               24 1/2/18         
#> 3           3        4                 40               10 3/6/20
```


```r
table_B
#> # A tibble: 3 × 4
#>   customer_ID   age gender favorite
#>         <dbl> <dbl> <chr>  <chr>   
#> 1           1    50 M      t_shirts
#> 2           2    44 F      leggings
#> 3           4    30 F      jumpers
```

The general syntax for joins is...

```r
#join_type(firstTable, secondTable, by=columnTojoinOn)
```

`inner_join`  
Where did customers 3 and 4 go?

```r
inner_exampleDF <- inner_join(table_A, table_B, by="customer_ID")
inner_exampleDF
#> # A tibble: 2 × 8
#>   customer_ID n_orders total_value_orders ave_value_orders last_order_date   age
#>         <dbl>    <dbl>              <dbl>            <dbl> <chr>           <dbl>
#> 1           1        5                500              100 12/7/20            50
#> 2           2       10                240               24 1/2/18             44
#> # ℹ 2 more variables: gender <chr>, favorite <chr>
```

`left_join`
Where did customer 4 go? Notice the missing data for customer 3.

```r
left_exampleDF <- left_join(table_A, table_B, by="customer_ID")
left_exampleDF
#> # A tibble: 3 × 8
#>   customer_ID n_orders total_value_orders ave_value_orders last_order_date   age
#>         <dbl>    <dbl>              <dbl>            <dbl> <chr>           <dbl>
#> 1           1        5                500              100 12/7/20            50
#> 2           2       10                240               24 1/2/18             44
#> 3           3        4                 40               10 3/6/20             NA
#> # ℹ 2 more variables: gender <chr>, favorite <chr>
```

`right_join`
Where did customer 3 go? Notice the missing data for customer 4.

```r
right_exampleDF <- right_join(table_A, table_B, by="customer_ID")
right_exampleDF
#> # A tibble: 3 × 8
#>   customer_ID n_orders total_value_orders ave_value_orders last_order_date   age
#>         <dbl>    <dbl>              <dbl>            <dbl> <chr>           <dbl>
#> 1           1        5                500              100 12/7/20            50
#> 2           2       10                240               24 1/2/18             44
#> 3           4       NA                 NA               NA <NA>               30
#> # ℹ 2 more variables: gender <chr>, favorite <chr>
```

`full_join`

```r
full_exampleDF <- full_join(table_A, table_B, by="customer_ID")
full_exampleDF
#> # A tibble: 4 × 8
#>   customer_ID n_orders total_value_orders ave_value_orders last_order_date   age
#>         <dbl>    <dbl>              <dbl>            <dbl> <chr>           <dbl>
#> 1           1        5                500              100 12/7/20            50
#> 2           2       10                240               24 1/2/18             44
#> 3           3        4                 40               10 3/6/20             NA
#> 4           4       NA                 NA               NA <NA>               30
#> # ℹ 2 more variables: gender <chr>, favorite <chr>
```

`anti_join`
Provides the rows in the first table for which there are not matching values in the second table.

```r
anti_exampleDF <- anti_join(table_A, table_B, by="customer_ID")
anti_exampleDF
#> # A tibble: 1 × 5
#>   customer_ID n_orders total_value_orders ave_value_orders last_order_date
#>         <dbl>    <dbl>              <dbl>            <dbl> <chr>          
#> 1           3        4                 40               10 3/6/20
```

## Joining the spider data
Here, the latitude and longitude for each spider were recorded from the field records at a later date, and now we need to join it to our `spiders_all` data frame. The lat/long were recorded into one single file for each observation. Let's read in the lat/long data.

```r
spiders_locs <- read_csv("data/spiders locations/spiders_locations.csv")
```

We will use a join here to merge lat/long to our data frame. Both files contain a unique identifier called `Accession` which we will use to join.  



## Practice
1. Which type of join is most appropriate in this case?  


As a side note, joining data can highlight problems or typos with the data when the join does not go as expected.  

## Formatting Dates
We now have a single data frame with all of our spider data including locations. That was a lot of work, even with R. But remember, now we have a reproducible work flow starting from the original files. This work flow serves as a record of what we did, keeps the original files untouched, and can make it easier to track down problems later in our analysis. Most importantly, everyone who uses our R script will know exactly what we did!  

There is one last thing to change. Did you notice the date column? It seems to be in the format Day/Month/Year. 

```r
#class(spiders_with_locs$Date)
#glimpse(spiders_with_locs)
```

The `lubridate` package was specifically created to deal with dates of all types. There are many useful functions in `lubridate` for working with dates. Please see the excellent tutorial provided by [RichardOnData](https://www.youtube.com/watch?v=VYAo69WdJZg&ab_channel=RichardOnData).

```r
day <- today()
day
#> [1] "2024-02-29"
```


```r
str(day)
#>  Date[1:1], format: "2024-02-29"
```


```r
datetime <- now()
datetime
#> [1] "2024-02-29 13:22:28 PST"
```

We want to change our date column to the standard "YEAR-MO-DA" format that R will recognize as a date. Right now it is listed as day-month-year. We can use the base R function `as.Date()` or the lubridate function `dmy` for this. 

```r
#dmy(spiders_with_locs$Date)
```

There are many different options for working with dates and datetimes in lubridate including `ymd`, `mdy`, `dmy`, `mdy_hms`, `ymd_hms`.

```r
dateformat1 <- "20200922"
dateformat2 <- "09-22-2020"
dateformat3 <- "22/09/2020"
dateformat4 <- "09-22-2020 17:00:00"
dateformat5 <- "20200922 170000"
```

## Practice 
1. Convert each of the examples above using lubridate.

```r
ymd(dateformat1)
#> [1] "2020-09-22"
```


```r
mdy(dateformat2)
#> [1] "2020-09-22"
```


```r
dmy(dateformat3)
#> [1] "2020-09-22"
```


```r
mdy_hms(dateformat4)
#> [1] "2020-09-22 17:00:00 UTC"
```


```r
ymd_hms(dateformat5)
#> [1] "2020-09-22 17:00:00 UTC"
```

## Export for part 2  
We need to save our final data to a `.csv` so we can use it in part 2. 

```r
#write.csv(spiders_with_locs, file = "spiders_with_locs.csv", row.names = FALSE)
```

## That's it, let's take a break!   

-->[Home](https://jmledford3115.github.io/datascibiol/)
